{"version":3,"sources":["node_modules/auto-reload-brunch/vendor/auto-reload.js","app/javascripts/initial/app.js"],"names":["WebSocket","window","MozWebSocket","br","brunch","ar","disabled","cacheBuster","url","date","Math","round","Date","now","toString","replace","indexOf","browser","navigator","userAgent","toLowerCase","forceRepaint","reloaders","page","location","reload","stylesheet","slice","call","document","querySelectorAll","filter","link","val","getAttribute","href","forEach","setTimeout","body","offsetHeight","port","host","server","hostname","connect","connection","onmessage","event","message","data","reloader","onerror","readyState","close","onclose","Search","init","search","instantsearch","appId","apiKey","indexName","addSearchBoxWidget","addStatsWidget","addTagsWidget","addSortByWidget","addHitsWidget","addPaginationWidget","start","getHighlightedValue","object","property","_","has","console","info","_highlightResult","value","transformItem","input","image","authorUrl","commentCount","comments","commentCout","moment","unix","publishedDate","format","title","author","description","tags","_initialData","JSON","stringify","addWidget","widgets","searchBox","container","placeholder","wrapInput","stats","cssClasses","root","refinementList","attributeName","operator","limit","header","templates","sortBySelector","indices","name","label","hitTemplate","getElementById","innerHTML","emptyTemplate","hits","hitsPerPage","empty","item","transformData","pagination"],"mappings":"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","file":"public/initial.js","sourcesContent":["/* jshint ignore:start */\n(function() {\n  var WebSocket = window.WebSocket || window.MozWebSocket;\n  var br = window.brunch = (window.brunch || {});\n  var ar = br['auto-reload'] = (br['auto-reload'] || {});\n  if (!WebSocket || ar.disabled) return;\n\n  var cacheBuster = function(url){\n    var date = Math.round(Date.now() / 1000).toString();\n    url = url.replace(/(\\&|\\\\?)cacheBuster=\\d*/, '');\n    return url + (url.indexOf('?') >= 0 ? '&' : '?') +'cacheBuster=' + date;\n  };\n\n  var browser = navigator.userAgent.toLowerCase();\n  var forceRepaint = ar.forceRepaint || browser.indexOf('chrome') > -1;\n\n  var reloaders = {\n    page: function(){\n      window.location.reload(true);\n    },\n\n    stylesheet: function(){\n      [].slice\n        .call(document.querySelectorAll('link[rel=stylesheet]'))\n        .filter(function(link) {\n          var val = link.getAttribute('data-autoreload');\n          return link.href && val != 'false';\n        })\n        .forEach(function(link) {\n          link.href = cacheBuster(link.href);\n        });\n\n      // Hack to force page repaint after 25ms.\n      if (forceRepaint) setTimeout(function() { document.body.offsetHeight; }, 25);\n    }\n  };\n  var port = ar.port || 9485;\n  var host = br.server || window.location.hostname || 'localhost';\n\n  var connect = function(){\n    var connection = new WebSocket('ws://' + host + ':' + port);\n    connection.onmessage = function(event){\n      if (ar.disabled) return;\n      var message = event.data;\n      var reloader = reloaders[message] || reloaders.page;\n      reloader();\n    };\n    connection.onerror = function(){\n      if (connection.readyState) connection.close();\n    };\n    connection.onclose = function(){\n      window.setTimeout(connect, 1000);\n    };\n  };\n  connect();\n})();\n/* jshint ignore:end */","let Search = {\n  init() {\n    this.search = instantsearch({\n      appId: 'latency',\n      apiKey: 'c80a1f43b1650d1a2225d95d6df0ffab',\n      indexName: 'smashingmagazine'\n    });\n\n    this.addSearchBoxWidget();\n    this.addStatsWidget();\n    this.addTagsWidget();\n    this.addSortByWidget();\n    this.addHitsWidget();\n    this.addPaginationWidget();\n\n    this.search.start();\n  },\n  getHighlightedValue(object, property) {\n    if (!_.has(object, `_highlightResult.${property}.value`)) {\n      console.info(object, property);\n      return object[property];\n    }\n    return object._highlightResult[property].value;\n  },\n  transformItem(input) {\n    let data = {\n      url: input.url,\n      image: input.image,\n      authorUrl: input.authorUrl\n    };\n\n    // Add the number of comments\n    if (input.commentCount > 1) {\n      data.comments = `${input.commentCount} Comments`;\n    } else {\n      data.comments = input.commentCout === 0 ? null : '1 Comment';\n    }\n\n    // Display date in human readable form\n    data.date = moment.unix(input.publishedDate).format('MMMM Do, YYYY');\n\n    // Pass highlighted versions\n    data.title = Search.getHighlightedValue(input, 'title');\n    data.author = Search.getHighlightedValue(input, 'author');\n    data.description = Search.getHighlightedValue(input, 'description');\n\n    // TODO: Highlight tags\n    data.tags = input.tags;\n\n    // Keep a json version of the data, for easy debugging\n    data._initialData = JSON.stringify(input, null, 2);\n\n    return data;\n  },\n  addSearchBoxWidget() {\n    this.search.addWidget(\n      instantsearch.widgets.searchBox({\n        container: '#searching_2',\n        placeholder: 'Search in all Smashing posts',\n        wrapInput: false\n      })\n    );\n  },\n  addStatsWidget() {\n    this.search.addWidget(\n      instantsearch.widgets.stats({\n        container: '#search-stats',\n        cssClasses: {\n          root: 'search-stats'\n        }\n      })\n    );\n  },\n  addTagsWidget() {\n    this.search.addWidget(\n      instantsearch.widgets.refinementList({\n        container: '#search-tags',\n        attributeName: 'tags.name',\n        operator: 'and',\n        limit: 10,\n        cssClasses: {\n          root: 'search-tags',\n          header: 'search-tags-header'\n        },\n        templates: {\n          header: 'Tags'\n        }\n      })\n    );\n  },\n  addSortByWidget() {\n    this.search.addWidget(\n      instantsearch.widgets.sortBySelector({\n        container: '#search-sort-by',\n        indices: [\n          {name: 'smashingmagazine', label: 'Most relevant'},\n          {name: 'smashingmagazine_comment_count_desc', label: 'Most commented'},\n          {name: 'smashingmagazine_published_date_desc', label: 'Latest published'}\n        ]\n      })\n    );\n  },\n  addHitsWidget() {\n    let hitTemplate = document.getElementById('templateSearch-hit').innerHTML;\n    let emptyTemplate = 'No results';\n    this.search.addWidget(\n      instantsearch.widgets.hits({\n        container: '#search-hits',\n        hitsPerPage: 20,\n        cssClasses: {\n          root: 'search-hits'\n        },\n        templates: {\n          empty: emptyTemplate,\n          item: hitTemplate\n        },\n        transformData: {\n          item: Search.transformItem\n        }\n      })\n    );\n  },\n  addPaginationWidget() {\n    this.search.addWidget(\n      instantsearch.widgets.pagination({\n        container: '#search-pagination',\n        cssClasses: {\n          root: 'search-pagination'\n        }\n      })\n    );\n  }\n};\n\nexport default Search;\n"]}